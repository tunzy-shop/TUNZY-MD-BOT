<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>tunzy-md-bot â€” Pair</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    body{font-family:Arial,Helvetica,sans-serif;background:#0b0b0b;color:#fff;display:flex;align-items:center;justify-content:center;height:100vh;margin:0}
    .box{width:95%;max-width:560px;padding:28px;border-radius:12px;background:#0f1720;text-align:center}
    input{width:80%;padding:12px;border-radius:8px;border:1px solid #222;margin-bottom:10px;font-size:16px}
    button{padding:12px 20px;border-radius:8px;border:0;background:#0ea5a4;color:#000;font-weight:700;cursor:pointer}
    .code{margin-top:18px;font-size:28px;background:#020617;padding:16px;border-radius:8px;letter-spacing:4px;display:inline-block}
    .note{margin-top:8px;color:#9ca3af;font-size:13px}
  </style>
</head>
<body>
  <div class="box">
    <h1>tunzy-md-bot</h1>
    <p>Enter your WhatsApp number (with country code) to get your pairing code.</p>
    <input id="number" placeholder="+234XXXXXXXXXX" />
    <div style="margin-top:12px">
      <button onclick="generate()">Get Pairing Code</button>
    </div>
    <div id="result" style="margin-top:18px"></div>
    <p class="note">After pairing the bot will start for your number. If code shows ALREADY-PAIRED, open bot in your WhatsApp linked devices.</p>
  </div>

  <script>
    async function generate(){
      document.getElementById("result").innerHTML = "Generating...";
      const number = document.getElementById("number").value.trim();
      if(!number){ document.getElementById("result").innerHTML = "<span style='color:#f87171'>Enter number</span>"; return; }
      try {
        const r = await fetch("/generate", {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify({ number })
        });
        const j = await r.json();
        if(j.error) {
          document.getElementById("result").innerHTML = `<div style="color:#f87171">${j.error}</div>`;
        } else if(j.code === "ALREADY-PAIRED") {
          document.getElementById("result").innerHTML = `<div class="code">ALREADY-PAIRED</div><div style="margin-top:8px;color:#9ca3af">Bot already active for that number.</div>`;
        } else {
          document.getElementById("result").innerHTML = `<div class="code">${j.code}</div><div style="margin-top:8px;color:#9ca3af">Use this code in the pairing flow (enter in your WhatsApp device pairing UI).</div>`;
        }
      } catch (e) {
        document.getElementById("result").innerHTML = "<div style='color:#f87171'>Server error</div>";
      }
    }
  </script>
</body>
</html>
